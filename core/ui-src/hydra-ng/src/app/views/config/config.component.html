<div class="config-container">
  <!-- Header with Advanced Toggle -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Configuration</h2>
    <div class="d-flex align-items-center gap-3">
      <div class="form-check form-switch">
        <input class="form-check-input"
               type="checkbox"
               [checked]="showAdvanced()"
               (change)="toggleAdvanced()"
               id="advancedToggle">
        <label class="form-check-label" for="advancedToggle">
          Show Advanced Settings
        </label>
      </div>
    </div>
  </div>
  
  <!-- Loading State -->
  <div *ngIf="isLoading()" class="text-center py-5">
    <div class="spinner-border" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-2">Loading configuration...</p>
  </div>
  
  <!-- Config Content -->
  <div *ngIf="!isLoading()" class="config-content">
    <!-- Tab Navigation -->
    <ul class="nav nav-tabs" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link"
                [class.active]="activeTab === 'main'"
                (click)="setActiveTab('main')"
                type="button"
                role="tab">
          Main
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link"
                [class.active]="activeTab === 'auth'"
                (click)="setActiveTab('auth')"
                type="button"
                role="tab">
          Authorization
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link"
                [class.active]="activeTab === 'searching'"
                (click)="setActiveTab('searching')"
                type="button"
                role="tab">
          Searching
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link"
                [class.active]="activeTab === 'categories'"
                (click)="setActiveTab('categories')"
                type="button"
                role="tab">
          Categories
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link"
                [class.active]="activeTab === 'downloading'"
                (click)="setActiveTab('downloading')"
                type="button"
                role="tab">
          Downloading
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link"
                [class.active]="activeTab === 'indexers'"
                (click)="setActiveTab('indexers')"
                type="button"
                role="tab">
          Indexers
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link"
                [class.active]="activeTab === 'notifications'"
                (click)="setActiveTab('notifications')"
                type="button"
                role="tab">
          Notifications
        </button>
      </li>
    </ul>
    
    <!-- Tab Content -->
    <div class="tab-content mt-3">
      <!-- Main Tab -->
      <div *ngIf="activeTab === 'main'">
        <app-main-config-tab
          [showAdvanced]="showAdvanced()"
          (dirtyChange)="onFormDirtyChange($event)"
          (validChange)="onFormValidChange($event)">
        </app-main-config-tab>
      </div>
      
      <!-- Auth Tab -->
      <div *ngIf="activeTab === 'auth'">
        <app-auth-config-tab
          [showAdvanced]="showAdvanced()"
          (dirtyChange)="onFormDirtyChange($event)"
          (validChange)="onFormValidChange($event)">
        </app-auth-config-tab>
      </div>
      
      <!-- Searching Tab -->
      <div *ngIf="activeTab === 'searching'">
        <app-searching-config-tab
          [showAdvanced]="showAdvanced()"
          (dirtyChange)="onFormDirtyChange($event)"
          (validChange)="onFormValidChange($event)">
        </app-searching-config-tab>
      </div>
      
      <!-- Categories Tab -->
      <div *ngIf="activeTab === 'categories'">
        <app-categories-config-tab
          [showAdvanced]="showAdvanced()"
          (dirtyChange)="onFormDirtyChange($event)"
          (validChange)="onFormValidChange($event)">
        </app-categories-config-tab>
      </div>
      
      <!-- Downloading Tab -->
      <div *ngIf="activeTab === 'downloading'">
        <app-downloading-config-tab
          [showAdvanced]="showAdvanced()"
          (dirtyChange)="onFormDirtyChange($event)"
          (validChange)="onFormValidChange($event)">
        </app-downloading-config-tab>
      </div>
      
      <!-- Indexers Tab -->
      <div *ngIf="activeTab === 'indexers'">
        <app-indexers-config-tab
          [showAdvanced]="showAdvanced()"
          (dirtyChange)="onFormDirtyChange($event)"
          (validChange)="onFormValidChange($event)">
        </app-indexers-config-tab>
      </div>
      
      <!-- Notifications Tab -->
      <div *ngIf="activeTab === 'notifications'">
        <app-notifications-config-tab
          [showAdvanced]="showAdvanced()"
          (dirtyChange)="onFormDirtyChange($event)"
          (validChange)="onFormValidChange($event)">
        </app-notifications-config-tab>
      </div>
    </div>
    
    <!-- Save Button -->
    <div class="d-flex justify-content-end mt-4">
      <button class="btn btn-primary"
              [disabled]="!hasUnsavedChanges() || isSaving()"
              (click)="saveConfig()">
        <span *ngIf="isSaving()" class="spinner-border spinner-border-sm me-2"></span>
        {{ isSaving() ? 'Saving...' : 'Save Configuration' }}
      </button>
    </div>
  </div>
</div> 